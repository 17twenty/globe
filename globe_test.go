package globe

import (
	"testing"

	"github.com/stretchr/testify/assert"
)

func TestCartestian(t *testing.T) {
	x, y, z := cartestian(42, -163)
	assert.Equal(t, -0.7106729309733519, x)
	assert.Equal(t, -0.2172745194807066, y)
	assert.Equal(t, -0.6691306063588582, z)
}

func TestHaversine(t *testing.T) {
	cases := []struct {
		Lat1, Lng1 float64
		Lat2, Lng2 float64
		Distance   float64
	}{
		{61.76543033984557, 37.67770367266306, -7.156018382728888, 59.24161915865653, 7886.581201923186},
		{21.940661070124392, -27.130501054344364, -43.39006318567746, -156.37067308170856, 14798.28914867192},
		{-23.464218263492626, -145.09097319078558, 38.849724010954006, 5.4765462607435325, 16755.646528079917},
		{-13.808977659204544, -102.86500587034503, -3.5672654028449813, -65.49905724108126, 4254.824289188308},
		{-24.44353568488961, -78.10770557503974, -34.25616705840568, 64.47048333127782, 12385.613939186398},
		{-16.156214450511584, -106.85272440696376, 46.46742324464643, 25.442379385568103, 14489.882829355967},
		{-23.94345515581749, -74.4788719606111, -35.93270748905276, 90.92629279858028, 13182.635916739864},
		{23.168612332699823, 131.52060468056197, -70.62954835525073, 8.575310178000308, 13619.095429569754},
		{12.38659860174893, -123.00182001175405, -57.25569219003512, 171.08698278980825, 9783.195280980919},
		{-61.85524721381324, 34.13109516590251, -23.387935711306838, 69.12885144712033, 5025.638176612954},
	}
	for _, c := range cases {
		d := haversine(c.Lat1, c.Lng1, c.Lat2, c.Lng2)
		assert.InDelta(t, c.Distance, d, 0.00001)
	}
}
